var ratchet=function(){function a(a,b){this.value=parseFloat(a)||a,this.units=typeof b!="undefined"?b:"px"}function b(b,c){c=c||{},this.type=b,this.x=new a(typeof c.x!="undefined"?c.x:0,c.units),this.y=new a(typeof c.y!="undefined"?c.y:0,c.units),c.z&&(this.z=new a(c.z,c.units))}function d(a){a=a||{},a.scale=a.scale||{},a.scale.units="",a.rotate=a.rotate||{},a.rotate.units="deg",this.translate=new b("translate",a.translate),this.rotate=new b("rotate",a.rotate),this.scale=new b("scale",a.scale)}function e(b,c){return function(d){var e,f;if(typeof c=="undefined"||c)e=d[b+1];return new a(d[b],e)}}function f(a,b){var c=a+"\\(";return(b||"").split(/\s/).forEach(function(a){c+=g[a]}),new RegExp(c+"\\)")}function i(a){var c=new d,e,f,g,i,j;for(e in h)h[e].forEach(function(d){f=d.regex.exec(a),g={};if(f){if(typeof d.extract=="function")d.extract(f,g);else for(i in d)i!=="regex"&&typeof d[i]=="function"&&(g[i]=d[i](f));c[e]=new b(e,g)}});return c}function j(a){if(typeof a=="string"||a instanceof String)return i(a)}a.prototype.valueOf=function(){return this.value},a.prototype.toString=function(){return this.value+this.units},a.prototype.matchingUnits=function(){var a=!0;for(var b=arguments.length;b--;)a=arguments[b].units===this.units;return a},b.prototype.add=function(a){var c=this.x.valueOf(),d=this.y.valueOf(),e=this.z?this.z.valueOf():0;if(typeof a=="number")c+=a,d+=a,e=typeof this.z!="undefined"?e+a:0;else for(var f=arguments.length;f--;)c+=arguments[f].x,d+=arguments[f].y,e+=arguments[f].z;return new b(this.type,{x:c,y:d,z:e})},b.prototype.mul=function(a){var c=this.x.valueOf(),d=this.y.valueOf(),e=this.z?this.z.valueOf():0;if(typeof a=="number")c*=a,d*=a,e=typeof this.z!="undefined"?e*a:0;else for(var f=arguments.length;f--;)c*=arguments[f].x,d*=arguments[f].y,e*=arguments[f].z;return new b(this.type,{x:c,y:d,z:e})},["sub","div"].forEach(function(a){var c=a==="sub",d=c?"add":"mul";b.prototype[a]=function(a){if(typeof a=="number")return this[d](c?-a:1/a);var e=Array.prototype.map.call(arguments,function(a){var d=new b(this.type,a);return c?(d.x=-d.x,d.y=-d.y,d.z=-d.z):(d.x=1/d.x,d.y=1/d.y,d.z=d.z?1/d.z:0),d});return this[d].apply(this,e)}}),b.prototype.toString=function(a){var b=[];return this.x.value&&(b[b.length]=this.type+"X("+this.x.value+this.x.units+")"),this.y.value&&(b[b.length]=this.type+"Y("+this.y.value+this.y.units+")"),this.z&&this.z.value&&(b[b.length]=this.type+"Z("+this.z.value+this.z.units+")"),b.join(" ")};var c={add:"mul",sub:"div"};d.prototype={toString:function(){var a=this.translate.toString(),b=this.rotate.toString(),c=this.scale.toString();return b&&(a+=(a?" ":"")+b),c&&(a+=(a?" ":"")+c),a}},["add","sub"].forEach(function(a){d.prototype[a]=function(){var e=new d;return e.translate=b.prototype[a].apply(this.translate,Array.prototype.map.call(arguments,function(a){return a.translate})),e.scale=b.prototype[c[a]].apply(this.scale,Array.prototype.map.call(arguments,function(a){return a.scale})),e.rotate=b.prototype[a].apply(this.rotate,Array.prototype.map.call(arguments,function(a){return a.rotate})),e}});var g={val:"(\\-?[\\d\\.]+)",unit:"([^s]+)",",":"\\,\\s*"},h={translate:[{regex:f("translate","val unit , val unit"),x:e(1),y:e(3)},{regex:f("translate(X|Y|Z)","val unit"),extract:function(a,b){b[a[1].toLowerCase()]=e(2)(a)}},{regex:f("translate","val unit , val unit , val unit"),x:e(1),y:e(3),z:e(5)}],rotate:[{regex:f("rotate","val unit"),z:e(1)},{regex:f("rotate(X|Y|Z)","val unit"),extract:function(a,b){b[a[1].toLowerCase()]=e(2)(a)}}],scale:[{regex:f("scale","val"),x:e(1,!1),y:e(1,!1)},{regex:f("scale","val , val"),x:e(1,!1),y:e(2,!1)}]};return j.fromString=i,j.Transform=d,j}()