var ratchet=function(){function a(a,b){var c=parseFloat(a);this.value=isNaN(c)?a:c,this.units=b||""}function b(b,c){var d;c=c||{},this.type=b,this.defaultValue=c.defaultValue||0,d=(c.x||{}).units||(c.y||{}).units||(c.z||{}).units||c.units,this.units=typeof d!="undefined"?d:"px",this.x=new a(typeof c.x!="undefined"?c.x:this.defaultValue,this.units),this.y=new a(typeof c.y!="undefined"?c.y:this.defaultValue,this.units),this.z=new a(typeof c.z!="undefined"?c.z:this.defaultValue,this.units)}function d(a){a=a||{},a.scale=a.scale||{},a.scale.units="",a.scale.defaultValue=1,a.rotate=a.rotate||{},a.rotate.units="deg",this.translate=new b("translate",a.translate),this.rotate=new b("rotate",a.rotate),this.scale=new b("scale",a.scale)}function e(b,c){return function(d){var e="",f;if(typeof c=="undefined"||c)e=d[b+1]||undefined;return new a(d[b],e)}}function f(a,b){var c=a+"\\(";return(b||"").split(/\s/).forEach(function(a){c+=g[a]}),new RegExp(c+"\\)")}function j(a){var c=new d,e,f,g,j,k,l;for(e in i)i[e].forEach(function(d){l=a,f=d.regex.exec(l);while(f){g=g||{};if(typeof d.extract=="function")d.extract(f,g);else for(j in d)j!=="regex"&&typeof d[j]=="function"&&(g[j]=d[j](f));g.units=h[e],l=l.slice(0,f.index)+l.slice(f.index+f[0].length),d.multi?f=d.regex.exec(l):f=null}g&&(c[e]=new b(e,g),g=undefined)});return c}function k(a){if(typeof a=="string"||a instanceof String)return j(a)}a.prototype.valueOf=function(){return this.value},a.prototype.toString=function(){return this.value+this.units},a.prototype.matchingUnits=function(){var a=!0;for(var b=arguments.length;b--;)a=arguments[b].units===this.units;return a},b.prototype.add=function(a){var c=this.x.valueOf(),d=this.y.valueOf(),e=this.z.valueOf();if(typeof a=="number")c+=a,d+=a,e=e?e+a:0;else for(var f=arguments.length;f--;)c+=arguments[f].x||0,d+=arguments[f].y||0,e=e||arguments[f].z?e+(arguments[f].z||0):0;return new b(this.type,{x:c,y:d,z:e,units:this.units})},b.prototype.mul=function(a){var c=this.x.valueOf(),d=this.y.valueOf(),e=this.z?this.z.valueOf():0;if(typeof a=="number")c*=a,d*=a,e=typeof this.z!="undefined"?e*a:0;else for(var f=arguments.length;f--;)c*=arguments[f].x,d*=arguments[f].y,e*=arguments[f].z;return new b(this.type,{x:c,y:d,z:e,units:this.units})},["sub","div"].forEach(function(a){var c=a==="sub",d=c?"add":"mul";b.prototype[a]=function(a){if(typeof a=="number")return this[d](c?-a:1/a);var e=Array.prototype.map.call(arguments,function(a){var d=new b(this.type,a);return c?(d.x=-d.x,d.y=-d.y,d.z=-d.z):(d.x=1/d.x,d.y=1/d.y,d.z=d.z?1/d.z:0),d});return this[d].apply(this,e)}}),b.prototype.toString=function(a){var b=[];a=a||{};if(a.all||this.x.value!=this.defaultValue)b[b.length]=this.type+"X("+this.x.value+this.x.units+")";if(a.all||this.y.value!=this.defaultValue)b[b.length]=this.type+"Y("+this.y.value+this.y.units+")";if(a.all||this.z.value!=this.defaultValue)b[b.length]=this.type+"Z("+this.z.value+this.z.units+")";return b.join(" ")};var c={add:"mul",sub:"div"};d.prototype={clone:function(){return new d({translate:this.translate,scale:this.scale,rotate:this.rotate})},toString:function(a){var b=this.translate.toString(a),c=this.rotate.toString(a),d=this.scale.toString(a);return c&&(b+=(b?" ":"")+c),d&&(b+=(b?" ":"")+d),b}},["add","sub"].forEach(function(a){d.prototype[a]=function(){var e=new d;return e.translate=b.prototype[a].apply(this.translate,Array.prototype.map.call(arguments,function(a){return a.translate})),e.scale=b.prototype[c[a]].apply(this.scale,Array.prototype.map.call(arguments,function(a){return a.scale})),e.rotate=b.prototype[a].apply(this.rotate,Array.prototype.map.call(arguments,function(a){return a.rotate})),e}});var g={val:"(\\-?[\\d\\.]+)",unit:"([^\\s]*)",",":"\\,\\s*"},h={translate:"px",rotate:"deg",scale:""},i={translate:[{regex:f("translate","val unit , val unit"),x:e(1),y:e(3)},{regex:f("translate(X|Y|Z)","val unit"),extract:function(a,b){b[a[1].toLowerCase()]=e(2)(a)},multi:!0},{regex:f("translate","val unit , val unit , val unit"),x:e(1),y:e(3),z:e(5)}],rotate:[{regex:f("rotate","val unit"),z:e(1)},{regex:f("rotate(X|Y|Z)","val unit"),extract:function(a,b){b[a[1].toLowerCase()]=e(2)(a)},multi:!0}],scale:[{regex:f("scale","val"),x:e(1,!1),y:e(1,!1)},{regex:f("scale","val , val"),x:e(1,!1),y:e(2,!1)},{regex:f("scale(X|Y|Z)","val"),extract:function(a,b){b[a[1].toLowerCase()]=e(2,!1)(a)},multi:!0}]};return k.fromString=j,k.Transform=d,k}()